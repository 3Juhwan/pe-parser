# pe-parser

PE는 Portable Executable의 약어로, Windows 운영체제에서 사용되는 실행되는 실행 파일 형식을 말합니다. 32bit/64bit PE 파일을 파싱하는 Parser를 구현했습니다. 자세한 내용은 다음 글에서 참고할 수 있습니다. 

- [PE parser 만들기 1편](https://3juhwan.vercel.app/pe-parser-1)
- [PE parser 만들기 2편](https://3juhwan.vercel.app/pe-parser-2)

</br>

### Hex Code

```hex
0000 4D5A9000 03000000 04000000 FFFF0000 B8000000 00000000 40000000 00000000
0001 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00010000
0002 0E1FBA0E 00B409CD 21B8014C CD215468 69732070 726F6772 616D2063 616E6E6F
0003 74206265 2072756E 20696E20 444F5320 6D6F6465 2E0D0D0A 24000000 00000000
0004 106E06E6 540F68B5 540F68B5 540F68B5 5D77FBB5 5E0F68B5 816269B4 570F68B5
0005 81626DB4 460F68B5 81626CB4 5E0F68B5 81626BB4 560F68B5 0F6769B4 560F68B5
0006 540F69B5 670F68B5 C8616DB4 550F68B5 C86197B5 550F68B5 C8616AB4 550F68B5
0007 52696368 540F68B5 00000000 00000000 00000000 00000000 00000000 00000000
0008 50450000 64860600 D971815E 00000000 00000000 F0002200 0B020E18 00120000
0009 001E0000 00000000 B4170000 00100000 00000040 01000000 00100000 00020000
000A 06000000 00000000 06000000 00000000 00800000 00040000 00000000 03006081
000B 00001000 00000000 00100000 00000000 00001000 00000000 00100000 00000000
000C 00000000 10000000 00000000 00000000 CC370000 A0000000 00600000 E0010000
000D 00500000 A4010000 00000000 00000000 00700000 1C000000 60320000 70000000
000E 00000000 00000000 00000000 00000000 00000000 00000000 D0320000 08010000
000F 00000000 00000000 00300000 A8010000 00000000 00000000 00000000 00000000
0010 00000000 00000000 2E746578 74000000 E8110000 00100000 00120000 00040000
0011 00000000 00000000 00000000 20000060 2E726461 74610000 900E0000 00300000
0012 00100000 00160000 00000000 00000000 00000000 40000040 2E646174 61000000
0013 38060000 00400000 00020000 00260000 00000000 00000000 00000000 400000C0
0014 2E706461 74610000 A4010000 00500000 00020000 00280000 00000000 00000000
0015 00000000 40000040 2E727372 63000000 E0010000 00600000 00020000 002A0000
0016 00000000 00000000 00000000 40000040 2E72656C 6F630000 1C000000 00700000
0017 00020000 002C0000 00000000 00000000 00000000 40000042 00000000 00000000
0018 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
0019 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001A 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001B 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001C 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001D 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001E 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
001F 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
```


</br>

### Parsing

```text
------ DOS HEADER ------
e_magic: 0x5a4d
e_lfanew: 0x100

------ NT HEADER ------
Signature: 0x4550


------ FILE HEADER ------
Machine: 0x8664
NumberOfSections: 0x6
SizeOfOptionalHeader: 0xf0
Characteristics: 0x22


------ OPTIONAL HEADER ------
Magic: 0x20b
AddressOfEntryPoint: 0x17b4
ImageBase: 0x140000000
SectionAlignment: 0x1000
FileAlignment: 0x200
SizeOfImage: 0x8000
SizeOfHeaders: 0x400
NumberOfRvaAndSizes: 0x10


------ SECTION HEADER ------
Name: .text
VirtualSize: 0x11e8
VirtualAddress: 0x1000
SizeOfRawData: 0x1200
PointerToRawData: 0x400
Characteristics: 0x60000020


------ SECTION HEADER ------
Name: .rdata
VirtualSize: 0xe90
VirtualAddress: 0x3000
SizeOfRawData: 0x1000
PointerToRawData: 0x1600
Characteristics: 0x40000040


------ SECTION HEADER ------
Name: .data
VirtualSize: 0x638
VirtualAddress: 0x4000
SizeOfRawData: 0x200
PointerToRawData: 0x2600
Characteristics: 0xc0000040


------ SECTION HEADER ------
Name: .pdata
VirtualSize: 0x1a4
VirtualAddress: 0x5000
SizeOfRawData: 0x200
PointerToRawData: 0x2800
Characteristics: 0x40000040


------ SECTION HEADER ------
Name: .rsrc
VirtualSize: 0x1e0
VirtualAddress: 0x6000
SizeOfRawData: 0x200
PointerToRawData: 0x2a00
Characteristics: 0x40000040


------ SECTION HEADER ------
Name: .reloc
VirtualSize: 0x1c
VirtualAddress: 0x7000
SizeOfRawData: 0x200
PointerToRawData: 0x2c00
Characteristics: 0x42000040

```
